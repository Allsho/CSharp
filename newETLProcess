string ext = Path.GetExtension(filePath).ToLower();
string excelVersion = ext == ".xls" ? "Excel 8.0" : "Excel 12.0 Xml";
string connStrExcel = $"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={filePath};" +
                      $"Extended Properties=\"{excelVersion};HDR=No;IMEX=1\"";


ConvertExcelDateSerialsToDate(dt);


private void ConvertExcelDateSerialsToDate(DataTable dt)
{
    foreach (DataColumn col in dt.Columns)
    {
        if (col.ColumnName.ToLower().Contains("date"))
        {
            foreach (DataRow row in dt.Rows)
            {
                if (double.TryParse(row[col]?.ToString(), out double serial) &&
                    serial > 10000 && serial < 60000) // likely a date
                {
                    try
                    {
                        row[col] = DateTime.FromOADate(serial).ToString("yyyy-MM-dd");
                    }
                    catch { /* log if needed */ }
                }
            }
        }
    }
}
