private void ConvertExcelDateSerialsToDate(DataTable dt)
{
    foreach (DataColumn col in dt.Columns)
    {
        string colName = col.ColumnName.ToLower();
        if (colName.Contains("date") || colName.Contains("dob") || colName.Contains("start") || colName.Contains("end"))
        {
            foreach (DataRow row in dt.Rows)
            {
                var value = row[col];

                if (value == null || value == DBNull.Value)
                    continue;

                string valStr = value.ToString().Trim();

                // If already a valid DateTime string, leave it alone
                if (DateTime.TryParse(valStr, out _))
                    continue;

                // Try parsing Excel serials
                if (double.TryParse(valStr, out double serialVal))
                {
                    if (serialVal >= 10000 && serialVal <= 60000)
                    {
                        try
                        {
                            var converted = DateTime.FromOADate(serialVal);
                            row[col] = converted.ToString("yyyy-MM-dd");
                        }
                        catch
                        {
                            // Ignore bad conversions
                        }
                    }
                }
            }
        }
    }
}
