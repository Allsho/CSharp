        public void Main()
        {
            ConnectionManager smtpConnection = Dts.Connections["CM_SMTP_EXHUB"];
            string smtpServer = smtpConnection.Properties["SmtpServer"].GetValue(smtpConnection).ToString();

            try
            {
                var config = Config.LoadFromVariables(Dts.Variables);
                var summary = new EmailSummary();
                var processor = new FileProcessor(config, new Logger(Dts.Variables), Dts.Variables, summary);
                processor.Execute();

                // Send summary email
                summary.LoadFromDatabase(Dts.Variables["User::CM_OLEDB_ClaimsStage"].Value.ToString());

                string htmlBody = summary.GenerateHtml();
                var emailer = new Emailer(Dts.Variables);
                emailer.SendEmail(smtpServer, "File Processing Summary", htmlBody, config.PayerName);

                Dts.TaskResult = (int)ScriptResults.Success;
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error in Main(): {ex.Message}");
                new Logger(Dts.Variables).LogError("Main", ex.Message);
                Dts.TaskResult = (int)ScriptResults.Failure;
            }
        }
